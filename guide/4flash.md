---
layout: default
title: Перепрошивка
nav_order: 2
parent: Руководство
---

# Перепрошивка

1. TOC
{:toc}

Из коробки, клавиатуры прошиты раскладками с поддержкой Via из официального репо QMK. Для настройки через Via ничего делать не нужно.

{: .warning }
> Этот раздел предполагает знакомство с коммандной строкой. Здесь не будет подробных разъяснений каждого шага.

## Сетап

* **Windows**

    Установите [QMK_WSL](https://wsl.qmk.fm/). Также подойдет QMK_MSYS, но он значительно медленнее.

* **Linux/OS X**

    Следуйте [документации QMK](https://docs.qmk.fm/#/newbs_getting_started) до непосредственно прошивки. Если кратко:

    ```
    $ python3 -m pip install --user qmk
    $ git clone https://github.com/qmk/qmk_firmware.git
    $ cd qmk_firmware
    $ qmk setup
    ````

## Vial

{: .warning }
> Я не консультирую по вопросам касательно использования Vial.

Хотите прошить [Vial](https://get.vial.today/)? Если раскладки с поддержкой Via можно найти в официальном репо QMK, за Vial нужно идти в их [форк](https://github.com/vial-kb/vial-qmk/):

```
$ git clone https://github.com/vial-kb/vial-qmk.git
$ cd vial-qmk
$ qmk setup
```

Чтобы перейти обратно на офф. репо, просто `$ qmk setup` в нем.

## Кастомизация

Протестируйте build env и по необходимости решите проблемы:

```
$ qmk doctor
$ qmk compile -kb crkbd -km via
```

Если все хорошо, то можно вносить изменения в прошивку. Релевантные пути:

```
qmk_firmware/keyboards/<клавиатура>
qmk_firmware/keyboards/<клавиатура>/keymap/<раскладка>
```


## Прошивка

Половинки прошиваются по очереди, через USB. TRRS тут не фигурирует. Рекомендуется использовать USB-A/USB-C кабель.

Помните, что соединять/разъединять половинки включенной клавиатуры не стоит.

1. Подключите первую половинку.
2. Начните прошивку: `$ qmk flash -kb <клавиатура> -km <раскладка>`
3. Дождитесь компиляции. Вас попросят ресетнуть контроллер.
4. Дважды щелкните по ресет кнопке на половинке. Зачастую она расположена под щитком контроллера. Снимать щитки необязательно, можно воспользоваться пинцетом.

После окончания загрузки прошивки повторите шаги со второй половинкой.


## Интересные ссылки

- Подробный гайд по [homerowmods](https://precondition.github.io/home-row-mods): что, как и зачем *(англ.)*
- Раскладка [miryoku](https://github.com/manna-harbour/miryoku/tree/master/docs/reference): 36 клавиш, максимум функционала *(англ.)*
